#!/bin/bash

#Elimina el fichero /tmp/software donde mete la informacion de los paquetes a instalar.
rm /tmp/software 2>/dev/null

#crea fichero nuevo para actualizar cuando se le da a instalar software
echo 'clear' >> /tmp/software
echo 'echo -e "\nActualizando repositorios.\n"' >> /tmp/software
echo 'if [ $(which pkcon) ]' >> /tmp/software
echo 'then' >> /tmp/software
echo '    sudo pkcon update' >> /tmp/software
echo '    sudo apt update' >> /tmp/software
echo 'else' >> /tmp/software
echo '    sudo apt update' >> /tmp/software
echo 'fi' >> /tmp/software
echo 'echo -e "\nActualizacion de repositorios FINALIZADA.\n"' >> /tmp/software
echo 'echo -e "\nIniciando instalacion de software.\n"' >> /tmp/software

while :
do
    opcion=$(zenity --list --title="Instalacion de software.- MegaTools -" \
    --text="\nSelecciona una categoria de software y vete marcando el que mas te guste o necesites.\n" \
    --column "Categorias principales:" --column="Descripcion." \
    "NAVEGADORES" "Los principales navegadores para internet." \
    "AUDIO - VIDEO" "Software relacionado el el Audio y el Video." \
    "ENTORNOS GRAFICOS LINUX" "Los principales entornos graficos para linux basados en debian." \
    "UTILIDADES" "Cantidad de utilidades" \
    "OFIMATICA" "Software dedicado a la ofimatica" \
    "SERVIDORES" "Servidores para tu sistema, (ssh, ftp, smb, etc)" \
    "GESTOR DE PAQUETES" "Software para el control de paquetes. (snap apt etc)." \
    "PARA TU TERMINAL" "Software pensado para la terminal linux." \
    "DISCOS" "Software de control de discos duros y unidades en general." \
    "JUEGOS" "Pues ya lo dice todo, juegos." \
    "SEGURIDAD" "Software destinado a la seguridad de tu equipo." \
    "MENSAJERIA" "Software de mensajeria en red." \
    --width=650 \
    --height=650 \
    --ok-label="Aceptar" \
    --cancel-label="Atras" \
    --extra-button="Instalar Software Seleccionado")

    # Manejar la opciÃ³n seleccionada
    case $opcion in

        "NAVEGADORES")
            bash MenuPrincipal/InstalacionDeSosfware/Navegadores
            ;;

        "AUDIO - VIDEO")
            ;;

        "ENTORNOS GRAFICOS LINUX")
            ;;

        "UTILIDADES")
            ;;

        "OFIMATICA")
            ;;

        "SERVIDORES")
            ;;

        "GESTOR DE PAQUETES")
            ;;

        "PARA TU TERMINAL")
            ;;

        "DISCOS")
            ;;

        "JUEGOS")
            ;;

        "SEGURIDAD")
            ;;

        "MENSAJERIA")
            ;;

        "Instalar Software Seleccionado")
            #empieza la instalacion
            #actualiza repositorios
            (echo -e "Ejecutando (sudo apt update)\n " && sudo apt update 2>/dev/null && echo -e "\nTerminado el sudo apt update") | zenity --text-info --width=600 --height=400 --title="Actualizando repositorios - MegaTools" --auto-scroll

            bash /tmp/software | zenity --text-info --width=600 --height=400 --title="Instalando software seleccionado - MegaTools" --auto-scroll
            ;;

        *)
            if [ $? -eq 0 ]; then
                zenity --error --title="Instalacion de software - MegaTools -" --text="No has seleccionado ninguna categoria del menu." --width=300
            else
                #Elimina el fichero /tmp/software donde mete la informacion de los paquetes a instalar.
                rm /tmp/software 2>/dev/null
                exit 0
            fi
            ;;
    esac
done
#Elimina el fichero /tmp/software donde mete la informacion de los paquetes a instalar.
rm /tmp/software 2>/dev/null
